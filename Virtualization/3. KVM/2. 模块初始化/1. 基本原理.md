

# 1. 原理介绍

KVM模块分为三个主要模块：kvm.ko、kvm\-intel.ko和kvm\-amd.ko，这三个模块在初始化阶段的流程如图5\-4所示。

￼图5\-4 KVM模块初始化阶段:

![2019-07-05-21-29-03.png](./images/2019-07-05-21-29-03.png)

**KVM模块**可以**编译进内核**中，也可以作为**内核模块**在Linux系统启动完成**之后加载**。加载时，KVM 根据主机所用的体系架构是 Intel的 VMX技术还是AMD的SVM技术，会采用略微不同的加载流程。

Linux的**子模块入口**通常通过**module\_init**宏进行定义，由**内核进行调用**。KVM的初始化流程如图5\-5所示。
￼
图5\-5 KVM的初始化流程:

![2019-12-11-11-04-37.png](./images/2019-12-11-11-04-37.png)