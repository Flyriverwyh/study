
**VM-execution control**控制区域里面有 3 个重要的控制字段:

* `pin-based VM-execution controls` 字段
* `primary processor-based Vm-execution controls` 字段 
* `secondary processor-based Vm-execution controls` 字段

大部分的检查都基于这 3 个控制字段。当 `primary processor-based Vm-execution controls` 字段的“`activate secondary controls`”位（`bit 31`) 为 **1** 时，`secondary processor-based Vm-execution controls` 字段才有效。当 "`activate secondary controls`" 为 **0** 时，所有 `secondary processor-based Vm-execution controls` 字段的控制位都**被视为 0 值**。

# 检查 pin- based Vm-execution control 字段

pin- based VM execution control 字段的控制位设置必须符合 2.5.6.1 节所述，另外参见 3.5.1 节的表 3-5 所示。

当 secondary processor-based VM- execution control 字段的 virtual- -Interrupt  delivery”位为 1 时，“external- Interrupt exiting”位必须为 1

当 NMI exiting 为 0 时，“virtual NMIS”位必须为 0。也就是“virtual NMIS 允许设为 1 值的前提是“NMI exiting”位必须为 1

当“process posted interrupts”为 1 时，必须满足下面的所有条件。

 secondary processor- based VM- execution control 字段的  virtual-interrupl

 delivery”必须为 1。因此，连带“external- Interrupt exiting”必须为 1。

VM- -exit control 字段的“acknowledge interrupt on exit”必须为 1

 posted-interrupt notification vector 字段提供一个中断向量号，从 0 到 255

 posted-interrupt descriptor address 字段提供的物理地址 bis5:0 必须为 0, 也就是

必须对齐在 64 字节边界上。

 posted-interrupt descriptor address 字段提供的物理地址宽度不能超过  MAXPHYADDR 值。例如，当 MAXPHYADDR 为 36 时，地址值的 bits63:36 必须为 0。