

`IA32_VMX_MISC`寄存器提供了一些vmx的杂项信息.

![2020-06-28-23-20-30.png](./images/2020-06-28-23-20-30.png)

`bits 4:0`(5个bit) 提供一个 X 值，当 **TSC** 值的 `bit X` 改变时，`VMX-preemption timer count` 计数值将减 1。假如这个 X 值是 5, 那么表示当 TSC 的 `bit 5` 发生改变（0 变 1 或 1 变 0) 时, preemption timer count 计数值减 1。也就是说，**TSC 计数 32 次时**，preemption timer count值减 1.

bit5 为 1 时，表示当发生 VM-exit 行为时，将保存IA32EFER.LMA 的值在 VM  entry control 字段的“IA-32 e mode guest”位里。只有当 VMX 支持 unrestricted guest（不受限制的 guest）功能时，这个位才为 1 值。

bits8:6 是一个 mask 位值，提供虚拟处理器 Inactive 状态值的支持度，有下面的几个  Inactive 状态值：

bit6 为 1 时，支持 HLT 状态

bit7 为 1 时，支持 shutdown 状态

obit8 为 1 时，支持 wait-for-SIPI 状态

只有这些 Inactive 状态被支持时，才允许在 guest state 区域 activity state 字段设置相应的 Inactive 状态值。bits8:6 一般会返回 7（全部支持）。

bits24:16 指示支持的 CR3- -target 值的数量，一般会返回 4 值，表示支持 4 个 CR3 寄存器目标值。bits27:25 返回一个 N 值，这个 N 值用来计算出在 MSR 列表（M-exit MSR-load、VM- exit MSR- -store 以及 VM- entry Msr-load 列表）里推荐的 MSR 最大个数。计算方法是：个数= (N+1) ×512。一般会返回 0 值，表示列表里推荐最多支持 512 个 MSR。

bit28 为 1 时，表示支持 IA32 SMM MONITOR CTL 寄存器的 bit2 位能被设为 1 值。这个 bit2 置位时，表示执行 VMXOFF 指令时，SMI 能被解开阻塞。一般情况下  VMXOFF 指令的执行将阻塞 SMI 请求。
