
# 

在虚拟化平台上, 可能只有一份VMM存在, 但可以有多个VM实例存在. 每个VM需要有对应的VMCS(虚拟机控制结构)区域来控制, 而VMM本身也需要一个VMXON区域来进行一些记录或维护工作.

```assembly
vmxon [ebp + PCB.VmxonPhysicalPointer]
```

如上面, 执行VMXON指令, 需要提供一个VMXON指针作为操作数, 这个指针是物理地址, 指向VMXON区域.

## 分配VMXON区域

执行VMXON指令进入VMX operation模式前, 需要分配一块物理内存区域作为VMXON区域. 这块物理内存区域需要对齐在4K字节边界上. VMXON区域的大小和内存cache类型可以通过检查IA32\_VMX\_BASIC寄存器来获得.

....

## VMXON区域初始设置

VMXON区域的首8个字节结构与VMCS区域是一样的, 首4个字节为VMCS ID值, 下一个DWORD位置是VMX\-abort indicator字段, 存放VMX\-abort发生后的ID值, 如图.

![config](./images/3.png)

.........
